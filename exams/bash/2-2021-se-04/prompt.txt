Зад. 47 2021-SE-04

19
Разполагате с машина, на която е инсталиран специализиран софтуер, който ползва два потребителски
акаунта – o r a c l e и g r i d . За всеки от двата акаунта съществува директория, която ще наричаме di-
ag_dest и тя е от вида / u 0 1 / a p p / п о т р е б и т е л .
Всеки от потребителите би трябвало да има environment променлива O R A C L E _ H O M E , която указва абсолютен
път до директория във формат / п ъ т / д о / д и р . В поддиректорията b i n на зададената директория би
трябвало да има изпълним файл с име a d r c i .

Всеки от потребителите може да подаде серия от подкоманди, които неговото копие на a d r c i да
изпълни, като го извика с параметър e x e c = " c m d 1 ; c m d 2 ; c m d 3 " . Отделните подкоманди се разделят
с точка и запетая (; ). Командата a d r c i винаги приключва с exit code 0 .

Нека дефинираме следните подкоманди:

• S E T B A S E – за да се гарантира правилна работа на командата a d r c i , при всяко нейно извикване
първата подкоманда трябва да бъде от вида S E T B A S E d i a g _ d e s t , където diag_dest е абсолютният
път на съответната директория за дадения потребител
• S H O W H O M E S – подкоманда S H O W H O M E S извежда на STDOUT един от следните два изхода:
– вариант 1: (неуспех): N o A D R h o m e s a r e s e t
– вариант 2: (успех):

A D R H o m e s :
d i a g / r d b m s / o r c l b i / o r c l b i 1
d i a g / r d b m s / o r c l b i / o r c l b i 2
Ако командата се изпълни успешно, тя връща списък с един или повече ADR Homes, които са
релативни имена на директории спрямо diag_dest на съответният потребител.
От полученият списък с релативни пътища интересни за нас са само тези, които за име на
директория на второ ниво имат една от следните директории: c r s , t n s l s n r , k f o d , a s m или r d b m s .
• S E T H O M E P A T H – подкоманда S E T H O M E P A T H п ъ т задава активна работна директория, спрямо
която ще се изпълняват последващи подкоманди в рамките на същото изпълнение на a d r c i ;
път е релативен път до директория, спрямо изхода на S H O W H O M E S
• P U R G E – подкоманда P U R G E - A G E м и н у т и изтрива определени файлове в текущо активната работна

директория, по-стари от дефинираното време в минути. Забележка: изтриват се само безопасни
файлове, т.е. такива, чието изтриване няма да доведе до проблем. Дефиницията на безопасни
файлове е извън обхвата на тази задача.
Напишете shell скрипт, който може да се изпълнява само от някой от указаните два акаунта и приема

задължителен първи позиционен аргумент число (в часове, минимална стойност 2 часа). Скриптът
трябва да почиства безопасните файлове по-стари от зададените часове в интересните ADR Home-ове
на съответния потребител
