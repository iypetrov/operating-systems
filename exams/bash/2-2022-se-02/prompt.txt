Зад. 55 2022-SE-02 Дефинирана е система за бекъпване на сървъри, която държи направените архиви в
главна директория (която ще наричаме fubar), в която има четири под-директории за различни класове
бекъпи:
• 0 – съдържа годишни бекъпи
• 1 – съдържа месечни бекъпи
• 2 – съдържа седмични бекъпи
• 3 – съдържа дневни бекъпи
Всяка директория съдържа архивни файлове с имена във формат h o s t n a m e - a r e a - Y Y Y Y M M D D . t a r . x z ,
където:
• h o s t n a m e е името на някаква машина, която е бекъпвана;
• a r e a е типът бекъп за съответната машина;
• Y Y Y Y M M D D е датата, на която е направен бекъпа;
• никое от горните полета не може да съдържа тире или точка;
• някои от файловете могат да са symlink-ове.
Примерни имена на файлове:
a s t e r o - e t c - 2 0 2 2 0 3 2 3 . t a r . x z s t r a t i o s - e t c - 2 0 2 2 0 4 2 8 . t a r . x z n e s t o r - d b - 2 0 2 2 0 4 0 4 . t a r . x z
g i l a - s r v - 2 0 2 2 0 4 0 5 . t a r . x z c a t a l y s t - v a r - 2 0 2 2 0 4 0 6 . t a r . x z d r a k e - h o m e - 2 0 2 2 0 4 0 4 . t a r . x z
d o m i n i x - v a r - 2 0 2 2 0 4 0 4 . t a r . x z
Комбинацията от h o s t n a m e и a r e a дефинира уникален обект за бекъпване. Всички архивни файлове
са пълноценни бекъпи на даден обект и са достатъчни за неговото възстановяване при нужда (заб.
извън обхвата на задачата).
Ако даден файл е symlink, то той може да е валиден или счупен. Symlink-овете са създадени за удобство
и не ги считаме за пълноценни бекъпи.
Политиката ни за бекъп казва, че за да имаме валиден бекъп на даден обект, за него трябва да имаме
минимум 1 годишен, 2 месечни, 3 седмични и 4 дневни пълноценни бекъпа.
Важност:
• обектите са равни по важност помежду си;
• важността на класовете бекъпи е във възходящ ред по горния списък, т.е. при равни други
условия дневните бекъпи са по-ценни от седмичните и т.н.;
• в рамките на един клас бекъпи по-новите бекъпи са по-важни от по-старите.
Напишете shell скрипт, който приема два два задължителни позиционни аргумента – име на директория

и число в интервала [1, 99]. Примерно извикване: . / f o o . s h . / b a r / 3 0 където:
• директорията представлява главна директория (fubar) на описаната система за бекпъване;
• числото дефинира колко процента е максималното допустимо използвано място на файловата
система, в която се намира подадената директория.
За удобство приемаме, че директорията fubar и всички обекти в нея се намират в една и съща файлова
система.
Упътване: Командата d f извикана с аргумент име на файл/директория връща информация за файловата
система, в която той се намира. Пример:

$ d f . / R E A D M E . m d
F i l e s y s t e m 1 K - b l o c k s U s e d A v a i l a b l e U s e % M o u n t e d o n

/ d e v / m a p p e r / o 7 - h m 1 0 0 6 6 3 2 9 6 6 1 7 3 5 7 3 2 3 7 2 8 8 7 6 4 6 3 % / h o m e
Скриптът трябва да изтрива минимален брой пълноценни архивни файлове така, че:
• всеки обект да има валиден бекъп;
• обръща внимание на описаните по-горе важности;
• процентите използвано място върху файловата система да е не повече от подаденият параметър
(a ако това е невъзможно, скриптът да освободи колкото може повече място, без да нарушава
валидностите на бекъпите на обектите);

• не е допустимо след работата на скрипта да останат счупени symlink–ове
